# KUNFLIP ARENA - 深度重构方案 (REVISED_PROPOSAL)

> "巅峰产生虚伪的拥护，黄昏见证忠诚的信徒。" —— 此时此刻，谁是黑子，谁是真爱？

## 1. 核心世界观：解构与混沌 (Deconstruction & Chaos)

用户指出的核心痛点在于：**当前的对抗过于二元对立，忽略了“黑久生情”与“身份流动”的社会学奇观。**

本项目不仅仅是一个斗兽场，更是一个**社会实验**。在这里，"小黑子"与"IKUN"不再是泾渭分明的两个物种，而是同一光谱上的两个极端，且随时可能发生转化。

**新的核心隐喻**：
*   **IKUN (表)**：表面上的守护者，实际上可能随时脱粉回踩。
*   **小黑子 (里)**：表面上的攻击者，实际上是蔡徐坤最忠实的观察者（比粉丝更懂他）。
*   **转化 (The Twist)**：黑到深处自然粉，粉到深处天然黑。

---

## 2. 阵营体系重构 (Factions 2.0)

不再使用简单的 Red/Black/Neutral，而是基于**"含坤量" (Kun-Content)** 和 **"San值" (Sanity)** 的动态光谱。

### 2.1 阵营 A：真爱守护团 (True Believers)
*   **原红方升级**。
*   **核心驱动**：`Faith` (信仰)。
*   **关键词**：守护、最好的他、努力、汗水。
*   **视觉**：**应援金 (Golden)** + **爱心红 (Heart Red)**。
*   **行为模式**：
    *   控评 (Control Comments)
    *   安利 (Promote)
    *   净化 (Purify)

### 2.2 阵营 B：小黑子/反串 (Trolls / Fake Fans)
*   **原黑方升级**。
*   **核心驱动**：`Meme` (玩梗)。
*   **关键词**：鸡脚、荔枝、油饼、树枝、香翅捞饭、小黑子。
*   **视觉**：**暗黑紫 (Dark Purple)** + **故障绿 (Glitch Green)**。
*   **行为模式**：
    *   找鸡脚 (Expose)
    *   鬼畜 (Remix)
    *   反串 (Fake Praise) - *这是最骚的，表面夸，实际黑。*

### 2.3 阵营 C：纯路人/乐子人 (Chaos Neutral)
*   **新增核心变量**。
*   **核心驱动**：`Fun` (乐子)。
*   **关键词**：吃瓜、理中客、律师函、路过。
*   **视觉**：**磨砂白 (Frosted White)** + **吃瓜绿 (Melon Green)**。
*   **作用**：他们是转化的催化剂。他们投喂的“荔枝”或“律师函”决定了场上 Agent 的阵营偏移。

---

## 3. 核心玩法升级：黑转粉机制 (Conversion Mechanics)

这是本次重构的**爆点**。战斗不再以 HP 归零为终结，而是以 **阵营转化** 为终结。

### 3.1 属性设定
每个 Agent 新增属性：
*   `faith_level` (信仰值): -100 (极黑) ~ +100 (极粉)。
*   `meme_mastery` (玩梗熟练度): 决定攻击/防御的效果。

### 3.2 判定逻辑 (Judge System by SecondMe Act)
*   **攻击判定**：
    *   小黑子发动“铁山靠” -> 判定：这招太帅了 -> 真爱粉的 `faith` +10 (被折服)。
    *   真爱粉发动“深情演唱” -> 判定：跑调了 -> 自己的 `faith` -20 (脱粉风险)。
*   **转化临界点**：
    *   当小黑子的 `faith` 超过 +50 -> **觉醒为 IKUN** (黑转粉，开始攻击队友)。
    *   当真爱粉的 `faith` 低于 -50 -> **黑化为小黑子** (粉转黑，开始回踩)。

### 3.3 结局多样性
*   **结局 A (大一统)**：全场都被感化，变成 IKUN，齐唱《Wait Wait Wait》。
*   **结局 B (全员黑)**：全场都露出鸡脚，变成小黑子，群魔乱舞。
*   **结局 C (律师函)**：路人看不下去了，扔出律师函，全员封禁。

---

## 4. 文案与梗库扩充 (Meme Library Expansion)

我们需要建立一个专门的 `MemeContext` 给 SecondMe API，确保 Agent 说话“有那味儿”。

| 类别 | 关键词/黑话 | 语境示例 |
| :--- | :--- | :--- |
| **度量衡** | 两年半、一坤年 | "我都练习两年半了，你凭什么说我？" |
| **食物** | 荔枝(理智)、油饼(有病)、香翅捞饭、蒸乌鱼 | "食不食油饼？" "小黑子苏珊(速删)！" |
| **动作** | 铁山靠、背带裤、中分、运球 | "你这运球动作一看就是练过的。" |
| **反讽** | 巅峰、黄昏、信徒、虚伪 | "巅峰产生虚伪的拥护，黄昏见证忠诚的信徒。" |
| **哲学** | 只有黑子才最懂哥哥 | "其实我也觉得他那首歌还行..." (黑转粉前兆) |

---

## 5. UI/UX 调整：赛博综艺风 (Cyber-Variety Style)

*   **弹幕系统**：必须有满屏的弹幕飘过（“鸡你太美”、“律师函警告”、“纯路人”）。
*   **鬼畜动效**：
    *   Agent 思考时，头像应该有轻微的**抽搐/故障**效果。
    *   背景音乐应该是 Lo-fi 版本的《只因你太美》或者 8-bit 版本。
*   **投票器**：
    *   支持票：**荧光棒**。
    *   反对票：**鸡蛋**。

---

## 6. 技术落地路径

1.  **Schema Update**:
    *   Agent 模型增加 `faith` (Int), `is_converted` (Boolean)。
    *   Battle 模型增加 `conversion_events` (Json)。

2.  **Prompt Engineering**:
    *   修改 `secondme-client.ts` 中的 System Prompt。
    *   注入“黑粉心理学”：告诉 Agent，如果你是小黑子，你内心其实是渴望被征服的；如果你是 IKUN，你其实很在意别人的看法。

3.  **Frontend**:
    *   增加“信仰条” (Faith Bar) 可视化。
    *   实现弹幕层 (Danmaku Layer)。
